<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compte Rendu - Weather API</title>
    <link href='https://cdn.jsdelivr.net/npm/boxicons@2.0.5/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="../assets/css/styles.css">
    <link rel="stylesheet" href="compte-rendu-styles.css">
</head>
<body>
    <div class="compte-rendu">
        <a href="../index.html#work" class="compte-rendu__back">
            <i class='bx bx-arrow-back'></i> Retour au portfolio
        </a>

        <div class="compte-rendu__header">
            <h1 class="compte-rendu__title">Compte Rendu - Weather API</h1>
            <p class="compte-rendu__subtitle">Application web m√©t√©o avec g√©olocalisation</p>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üìã Informations g√©n√©rales</h2>
            <div class="compte-rendu__grid">
                <div class="compte-rendu__card">
                    <strong>Nom du projet :</strong> Weather API - Application M√©t√©o
                </div>
                <div class="compte-rendu__card">
                    <strong>Date de cr√©ation :</strong> Projet BTS SIO SLAM
                </div>
                <div class="compte-rendu__card">
                    <strong>Auteur :</strong> Abdelmalek Elidrissi
                </div>
                <div class="compte-rendu__card">
                    <strong>Type :</strong> Application web m√©t√©o avec g√©olocalisation
                </div>
            </div>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üéØ Objectifs du projet</h2>
            <ul class="compte-rendu__list">
                <li>Consultation de la m√©t√©o en temps r√©el bas√©e sur la g√©olocalisation</li>
                <li>Affichage des pr√©visions m√©t√©orologiques (horaires et 7 jours)</li>
                <li>Sauvegarde de l'historique des localisations consult√©es</li>
                <li>Affichage de la qualit√© de l'air</li>
                <li>Interface utilisateur moderne et responsive</li>
            </ul>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üõ†Ô∏è Technologies utilis√©es</h2>
            <h3 class="compte-rendu__subsection-title">Backend</h3>
            <span class="compte-rendu__badge">Node.js</span>
            <span class="compte-rendu__badge">Express.js 5.2.1</span>
            <span class="compte-rendu__badge">SQLite3 5.1.7</span>
            <span class="compte-rendu__badge">Node-fetch 2.7.0</span>
            <span class="compte-rendu__badge">Dotenv 17.2.3</span>
            
            <h3 class="compte-rendu__subsection-title">Frontend</h3>
            <span class="compte-rendu__badge">HTML5</span>
            <span class="compte-rendu__badge">CSS3</span>
            <span class="compte-rendu__badge">JavaScript ES6+</span>
            <span class="compte-rendu__badge">Bootstrap 5</span>
            <span class="compte-rendu__badge">Google Fonts</span>
            
            <h3 class="compte-rendu__subsection-title">API externe</h3>
            <span class="compte-rendu__badge">WeatherAPI.com</span>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üìÅ Structure du projet</h2>
            <div class="compte-rendu__code">
Projet-Weather-API-master/
‚îú‚îÄ‚îÄ index.js                 # Serveur Express principal (292 lignes)
‚îú‚îÄ‚îÄ package.json             # Configuration npm et d√©pendances
‚îú‚îÄ‚îÄ package-lock.json        # Version verrouill√©e des d√©pendances
‚îú‚îÄ‚îÄ .gitignore              # Fichiers ignor√©s par Git
‚îú‚îÄ‚îÄ weatherApp.db           # Base de donn√©es SQLite (cr√©√©e automatiquement)
‚îú‚îÄ‚îÄ weatherApp.db-journal   # Journal SQLite
‚îú‚îÄ‚îÄ weatherApp.sqbpro       # Projet SQLite
‚îú‚îÄ‚îÄ README.md               # Documentation principale
‚îú‚îÄ‚îÄ README_LOCAL.md         # Documentation locale
‚îî‚îÄ‚îÄ public/
    ‚îú‚îÄ‚îÄ index.html          # Page principale (~1450 lignes)
    ‚îú‚îÄ‚îÄ all.html            # Page d'affichage de l'historique
    ‚îú‚îÄ‚îÄ Images/
    ‚îÇ   ‚îî‚îÄ‚îÄ Meteo.jpg       # Images du projet
    ‚îî‚îÄ‚îÄ Meteo.jpg           # Image m√©t√©o
            </div>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üîß Fonctionnalit√©s impl√©ment√©es</h2>
            
            <h3 class="compte-rendu__subsection-title">1. G√©olocalisation automatique</h3>
            <ul class="compte-rendu__list">
                <li>D√©tection de la position via l'API Geolocation du navigateur</li>
                <li>R√©cup√©ration des coordonn√©es GPS (latitude/longitude)</li>
                <li>Gestion des erreurs avec messages explicites</li>
                <li>Demande de permission utilisateur avec gestion des refus</li>
            </ul>

            <h3 class="compte-rendu__subsection-title">2. R√©cup√©ration des donn√©es m√©t√©o</h3>
            <h4>M√©t√©o actuelle :</h4>
            <ul class="compte-rendu__list">
                <li>Temp√©rature (en Celsius)</li>
                <li>Conditions m√©t√©orologiques (description, ic√¥nes)</li>
                <li>Humidit√©</li>
                <li>Vitesse et direction du vent</li>
                <li>Pression atmosph√©rique</li>
                <li>Visibilit√©</li>
                <li>Indice UV</li>
            </ul>
            
            <h4>Pr√©visions m√©t√©o :</h4>
            <ul class="compte-rendu__list">
                <li>Pr√©visions horaires (prochaines 24 heures)</li>
                <li>Pr√©visions sur 7 jours</li>
                <li>Temp√©ratures maximales et minimales</li>
                <li>Probabilit√© de pr√©cipitations</li>
            </ul>
            
            <h4>Qualit√© de l'air :</h4>
            <ul class="compte-rendu__list">
                <li>Indice DEFRA (UK Air Quality Index)</li>
                <li>Concentration de PM2.5 (particules fines)</li>
                <li>Niveaux de pollution</li>
            </ul>

            <h3 class="compte-rendu__subsection-title">3. Base de donn√©es SQLite</h3>
            <p>Structure de la table <code>geoloc</code> :</p>
            <table class="compte-rendu__table">
                <thead>
                    <tr>
                        <th>Colonne</th>
                        <th>Type</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>id</td>
                        <td>INTEGER PRIMARY KEY AUTOINCREMENT</td>
                        <td>Identifiant unique</td>
                    </tr>
                    <tr>
                        <td>latitude</td>
                        <td>REAL NOT NULL</td>
                        <td>Coordonn√©e latitude</td>
                    </tr>
                    <tr>
                        <td>longitude</td>
                        <td>REAL NOT NULL</td>
                        <td>Coordonn√©e longitude</td>
                    </tr>
                    <tr>
                        <td>timestamp</td>
                        <td>INTEGER NOT NULL</td>
                        <td>Date et heure (Unix timestamp)</td>
                    </tr>
                    <tr>
                        <td>mood</td>
                        <td>TEXT NOT NULL</td>
                        <td>Humeur de l'utilisateur</td>
                    </tr>
                    <tr>
                        <td>pays</td>
                        <td>TEXT</td>
                        <td>Nom du pays</td>
                    </tr>
                    <tr>
                        <td>ville</td>
                        <td>TEXT</td>
                        <td>Nom de la ville</td>
                    </tr>
                    <tr>
                        <td>temperature</td>
                        <td>REAL</td>
                        <td>Temp√©rature enregistr√©e</td>
                    </tr>
                    <tr>
                        <td>condition</td>
                        <td>TEXT</td>
                        <td>Conditions m√©t√©orologiques</td>
                    </tr>
                    <tr>
                        <td>defra</td>
                        <td>REAL</td>
                        <td>Indice qualit√© de l'air DEFRA</td>
                    </tr>
                    <tr>
                        <td>pm25</td>
                        <td>REAL</td>
                        <td>Concentration de PM2.5</td>
                    </tr>
                </tbody>
            </table>

            <h3 class="compte-rendu__subsection-title">4. Configuration API</h3>
            <ul class="compte-rendu__list">
                <li>Configuration via l'interface web (recommand√©)</li>
                <li>Alternative : configuration via fichier .env</li>
                <li>Sauvegarde de la cl√© API dans la session serveur</li>
                <li>Validation de la cl√© API avant utilisation</li>
            </ul>

            <h3 class="compte-rendu__subsection-title">5. Historique des localisations</h3>
            <ul class="compte-rendu__list">
                <li>Page d√©di√©e (/all.html) affichant toutes les localisations</li>
                <li>Affichage format√© avec Bootstrap cards</li>
                <li>Tri par date (du plus r√©cent au plus ancien)</li>
                <li>Affichage des informations m√©t√©o enregistr√©es</li>
            </ul>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üåê Routes API expos√©es</h2>
            <table class="compte-rendu__table">
                <thead>
                    <tr>
                        <th>Route</th>
                        <th>M√©thode</th>
                        <th>Description</th>
                        <th>Param√®tres</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>/</td>
                        <td>GET</td>
                        <td>Page principale</td>
                        <td>Aucun</td>
                    </tr>
                    <tr>
                        <td>/all.html</td>
                        <td>GET</td>
                        <td>Page historique</td>
                        <td>Aucun</td>
                    </tr>
                    <tr>
                        <td>/weather</td>
                        <td>GET</td>
                        <td>Donn√©es m√©t√©o actuelles et pr√©visions</td>
                        <td>lat, lon, apiKey, country (optionnel)</td>
                    </tr>
                    <tr>
                        <td>/forecast</td>
                        <td>GET</td>
                        <td>Pr√©visions m√©t√©o uniquement</td>
                        <td>lat, lon, apiKey</td>
                    </tr>
                    <tr>
                        <td>/all</td>
                        <td>GET</td>
                        <td>Toutes les localisations (JSON)</td>
                        <td>Aucun</td>
                    </tr>
                    <tr>
                        <td>/api</td>
                        <td>POST</td>
                        <td>Sauvegarde localisation</td>
                        <td>Body JSON</td>
                    </tr>
                </tbody>
            </table>

            <h3 class="compte-rendu__subsection-title">Exemples d'utilisation</h3>
            <p><strong>GET /weather</strong></p>
            <div class="compte-rendu__code">
GET /weather?lat=48.8566&lon=2.3522&apiKey=YOUR_API_KEY
            </div>

            <p><strong>POST /api</strong></p>
            <div class="compte-rendu__code">
{
  "lat": 48.8566,
  "long": 2.3522,
  "timestamp": 1234567890,
  "mood": "Happy",
  "country": "France",
  "city": "Paris",
  "temperature": 15.5,
  "condition": "Sunny",
  "defra": 2,
  "pm25": 10.5
}
            </div>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üìä Sch√©ma de base de donn√©es</h2>
            <div class="compte-rendu__code">
CREATE TABLE IF NOT EXISTS geoloc (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    latitude REAL NOT NULL,
    longitude REAL NOT NULL,
    timestamp INTEGER NOT NULL,
    mood TEXT NOT NULL,
    pays TEXT,
    ville TEXT,
    temperature REAL,
    condition TEXT,
    defra REAL,
    pm25 REAL
);
            </div>
            <p><strong>Migrations :</strong> Le code g√®re automatiquement l'ajout de colonnes si elles n'existent pas d√©j√† (condition, defra, pm25).</p>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üöÄ Installation et d√©marrage</h2>
            <h3 class="compte-rendu__subsection-title">Pr√©requis</h3>
            <ul class="compte-rendu__list">
                <li>Node.js version 14 ou sup√©rieure</li>
                <li>npm (g√©n√©ralement inclus avec Node.js)</li>
                <li>Cl√© API WeatherAPI gratuite sur weatherapi.com</li>
            </ul>

            <h3 class="compte-rendu__subsection-title">√âtapes d'installation</h3>
            <ol class="compte-rendu__list" style="list-style: decimal; padding-left: 2rem;">
                <li><strong>Installer les d√©pendances</strong>
                    <div class="compte-rendu__code">cd Projets/Projet-Weather-API-master
npm install</div>
                </li>
                <li><strong>Configurer la cl√© API</strong>
                    <p>Option 1 - Via l'interface web (recommand√©) :</p>
                    <ul class="compte-rendu__list">
                        <li>Lancer le serveur : <code>node index.js</code></li>
                        <li>Ouvrir http://localhost:3000</li>
                        <li>Entrer la cl√© API dans la section "Configuration API"</li>
                    </ul>
                    <p>Option 2 - Via fichier .env :</p>
                    <div class="compte-rendu__code">WEATHER_API_KEY=votre_cle_api_ici</div>
                </li>
                <li><strong>Lancer le serveur</strong>
                    <div class="compte-rendu__code">node index.js</div>
                </li>
                <li><strong>Acc√©der √† l'application</strong>
                    <ul class="compte-rendu__list">
                        <li>Page principale : http://localhost:3000</li>
                        <li>Page historique : http://localhost:3000/all.html</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üí° Points techniques remarquables</h2>
            <div class="compte-rendu__grid">
                <div class="compte-rendu__card">
                    <h4>Architecture</h4>
                    <ul class="compte-rendu__list">
                        <li>Architecture REST</li>
                        <li>S√©paration backend/frontend</li>
                        <li>Base de donn√©es SQLite l√©g√®re</li>
                    </ul>
                </div>
                <div class="compte-rendu__card">
                    <h4>Gestion des erreurs</h4>
                    <ul class="compte-rendu__list">
                        <li>Erreurs de g√©olocalisation</li>
                        <li>Erreurs d'API externe</li>
                        <li>Validation des param√®tres</li>
                    </ul>
                </div>
                <div class="compte-rendu__card">
                    <h4>S√©curit√©</h4>
                    <ul class="compte-rendu__list">
                        <li>Protection SQL injection</li>
                        <li>Gestion s√©curis√©e cl√© API</li>
                        <li>Gestion CORS</li>
                    </ul>
                </div>
                <div class="compte-rendu__card">
                    <h4>Performance</h4>
                    <ul class="compte-rendu__list">
                        <li>Requ√™tes SQL optimis√©es</li>
                        <li>Gestion de session</li>
                        <li>Interface responsive</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üêõ Difficult√©s rencontr√©es et solutions</h2>
            
            <div class="compte-rendu__problem">
                <strong>Probl√®me 1 : G√©olocalisation non disponible</strong>
                <p>L'API de g√©olocalisation n√©cessite une autorisation explicite de l'utilisateur.</p>
            </div>
            <div class="compte-rendu__solution">
                <strong>Solution :</strong> Ajout d'un message d'erreur explicite demandant √† l'utilisateur d'autoriser la g√©olocalisation dans son navigateur. Gestion des cas o√π la g√©olocalisation n'est pas disponible.
            </div>

            <div class="compte-rendu__problem">
                <strong>Probl√®me 2 : Gestion des erreurs CORS</strong>
                <p>Les requ√™tes directes depuis le navigateur vers l'API WeatherAPI g√©n√®rent des erreurs CORS.</p>
            </div>
            <div class="compte-rendu__solution">
                <strong>Solution :</strong> Utilisation d'un serveur Express pour servir les fichiers statiques et agir comme proxy vers l'API externe, √©vitant ainsi les probl√®mes CORS.
            </div>

            <div class="compte-rendu__problem">
                <strong>Probl√®me 3 : Migration de sch√©ma de base de donn√©es</strong>
                <p>Ajout de nouvelles colonnes √† la table existante sans perdre les donn√©es.</p>
            </div>
            <div class="compte-rendu__solution">
                <strong>Solution :</strong> Ajout de colonnes conditionnelles avec gestion des erreurs pour les colonnes d√©j√† existantes. Utilisation d'ALTER TABLE avec v√©rification des erreurs.
            </div>

            <div class="compte-rendu__problem">
                <strong>Probl√®me 4 : Gestion de la cl√© API</strong>
                <p>Stockage s√©curis√© de la cl√© API c√¥t√© client ou serveur.</p>
            </div>
            <div class="compte-rendu__solution">
                <strong>Solution :</strong> Stockage de la cl√© API dans la session serveur Express, permettant une configuration unique par utilisateur sans exposer la cl√© dans le code client.
            </div>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üìà Am√©liorations possibles</h2>
            <div class="compte-rendu__grid">
                <div class="compte-rendu__card">
                    <h4>Fonctionnalit√©s</h4>
                    <ul class="compte-rendu__list">
                        <li>Authentification utilisateur</li>
                        <li>Graphiques de donn√©es</li>
                        <li>Notifications m√©t√©o</li>
                        <li>Export de donn√©es</li>
                        <li>Recherche de ville</li>
                    </ul>
                </div>
                <div class="compte-rendu__card">
                    <h4>Technique</h4>
                    <ul class="compte-rendu__list">
                        <li>Mode hors-ligne (Service Workers)</li>
                        <li>PWA (Progressive Web App)</li>
                        <li>Tests unitaires (Jest, Mocha)</li>
                        <li>Documentation Swagger/OpenAPI</li>
                        <li>Multi-langue (i18n)</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üìö Comp√©tences d√©velopp√©es</h2>
            <div class="compte-rendu__grid">
                <div class="compte-rendu__card">
                    <h4>Backend</h4>
                    <ul class="compte-rendu__list">
                        <li>API REST avec Node.js et Express</li>
                        <li>Gestion de base de donn√©es SQLite</li>
                        <li>Int√©gration d'API externes</li>
                        <li>Gestion des sessions</li>
                        <li>Gestion des erreurs et logs</li>
                    </ul>
                </div>
                <div class="compte-rendu__card">
                    <h4>Frontend</h4>
                    <ul class="compte-rendu__list">
                        <li>Interfaces web interactives</li>
                        <li>Bootstrap 5 responsive</li>
                        <li>G√©olocalisation navigateur</li>
                        <li>Manipulation DOM moderne</li>
                        <li>Gestion asynchrone (fetch, async/await)</li>
                    </ul>
                </div>
                <div class="compte-rendu__card">
                    <h4>Base de donn√©es</h4>
                    <ul class="compte-rendu__list">
                        <li>Mod√©lisation SQLite</li>
                        <li>Cr√©ation et migration de sch√©mas</li>
                        <li>Requ√™tes SQL optimis√©es</li>
                        <li>Gestion de l'historique</li>
                    </ul>
                </div>
                <div class="compte-rendu__card">
                    <h4>G√©n√©ral</h4>
                    <ul class="compte-rendu__list">
                        <li>Architecture REST</li>
                        <li>S√©curit√© web</li>
                        <li>Documentation de projet</li>
                        <li>Gestion de projet</li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="compte-rendu__section">
            <h2 class="compte-rendu__section-title">üéì Conclusion</h2>
            <p>Ce projet a permis de mettre en pratique les comp√©tences en d√©veloppement web full-stack. L'application combine efficacement les technologies backend (Node.js, Express) et frontend (HTML, CSS, JavaScript) pour cr√©er une solution fonctionnelle et utilisable.</p>
            
            <div class="compte-rendu__highlight">
                <strong>Points forts :</strong>
                <ul class="compte-rendu__list">
                    <li>Architecture bien structur√©e</li>
                    <li>Interface utilisateur moderne et responsive</li>
                    <li>Gestion compl√®te des erreurs</li>
                    <li>Documentation claire</li>
                </ul>
            </div>

            <p><strong>Prochaines √©tapes :</strong> Am√©lioration de l'interface utilisateur, ajout de fonctionnalit√©s avanc√©es (graphiques, notifications), optimisation des performances et transformation en PWA.</p>
        </div>
    </div>

    <script>
        // Animation au scroll
        const observerOptions = {
            threshold: 0.1,
            rootMargin: '0px 0px -50px 0px'
        };

        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    entry.target.style.opacity = '1';
                }
            });
        }, observerOptions);

        // Observer toutes les sections
        document.querySelectorAll('.compte-rendu__section').forEach(section => {
            section.style.opacity = '0';
            observer.observe(section);
        });

        // Animation pour les badges au scroll
        const badgeObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.style.animation = `fadeIn 0.5s ease-out ${index * 0.1}s both`;
                    }, index * 50);
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.compte-rendu__badge').forEach(badge => {
            badgeObserver.observe(badge);
        });

        // Animation pour les cartes
        const cardObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.style.animation = `fadeInUp 0.5s ease-out ${index * 0.1}s both`;
                    }, index * 50);
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.compte-rendu__card').forEach(card => {
            cardObserver.observe(card);
        });

        // Animation pour les lignes de tableau
        const tableObserver = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    entry.target.style.setProperty('--i', index);
                    entry.target.style.animation = `fadeInUp 0.4s ease-out ${index * 0.1}s both`;
                }
            });
        }, { threshold: 0.1 });

        document.querySelectorAll('.compte-rendu__table tbody tr').forEach(row => {
            tableObserver.observe(row);
        });

        // Effet parallaxe l√©ger sur le header
        window.addEventListener('scroll', () => {
            const header = document.querySelector('.compte-rendu__header');
            if (header) {
                const scrolled = window.pageYOffset;
                header.style.transform = `translateY(${scrolled * 0.3}px)`;
            }
        });

        // Animation au hover pour les sections
        document.querySelectorAll('.compte-rendu__section').forEach(section => {
            section.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-5px)';
            });
            section.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });

        // Effet de particules anim√©es (optionnel)
        function createParticle() {
            const particle = document.createElement('div');
            particle.style.position = 'absolute';
            particle.style.width = '4px';
            particle.style.height = '4px';
            particle.style.background = 'rgba(0, 212, 255, 0.6)';
            particle.style.borderRadius = '50%';
            particle.style.pointerEvents = 'none';
            particle.style.left = Math.random() * 100 + '%';
            particle.style.top = '100%';
            particle.style.animation = `floatUp ${3 + Math.random() * 2}s linear forwards`;
            
            const header = document.querySelector('.compte-rendu__header');
            if (header) {
                header.appendChild(particle);
                setTimeout(() => particle.remove(), 5000);
            }
        }

        // Cr√©er des particules p√©riodiquement
        setInterval(createParticle, 2000);

        // Ajouter l'animation floatUp
        const style = document.createElement('style');
        style.textContent = `
            @keyframes floatUp {
                to {
                    transform: translateY(-100vh) rotate(360deg);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
